{"version":3,"file":"commonHelpers.js","sources":["../src/js/getRefs.js","../src/js/render-function.js","../src/js/pixabay-api.js","../src/js/load-more-btn.js","../src/main.js"],"sourcesContent":["export default function getRefs() {\n  return {\n    searchForm: document.querySelector('.js-search-form'),\n    galleryContainer: document.querySelector('.js-gallery'),\n    loading: document.querySelector('.js-loading'),\n  };\n}\n","import getRefs from './getRefs';\n\nconst refs = getRefs();\n\nexport default function renderGalleryItems(images) {\n  const markup = images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `\n          <li class=\"gallery-item\">\n            <div class=\"thumb\">\n              <a href=\"${largeImageURL}\">\n                <img class=\"gallery-img\" src=\"${webformatURL}\" alt=\"${tags}\" />\n              </a>\n            </div>\n            <div class=\"meta\">\n              <div class=\"meta-column\">\n                <h3 class=\"meta-title\">Likes</h3>\n                <p class=\"meta-text\">${likes}</p>\n              </div>\n              <div class=\"meta-column\">\n                <h3 class=\"meta-title\">Views</h3>\n                <p class=\"meta-text\">${views}</p>\n              </div>\n              <div class=\"meta-column\">\n                <h3 class=\"meta-title\">Comments</h3>\n                <p class=\"meta-text\">${comments}</p>\n              </div>\n              <div class=\"meta-column\">\n                <h3 class=\"meta-title\">Downloads</h3>\n                <p class=\"meta-text\">${downloads}</p>\n              </div>\n            </div>\n          </li>\n        `;\n      }\n    )\n    .join('');\n\n  refs.galleryContainer.insertAdjacentHTML('beforeend', markup);\n}\n","import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nexport default class PixabayApiService {\n  constructor() {\n    this.searchQuery = '';\n    this.page = 1;\n    this.perPage = 15;\n  }\n\n  async fetchImages() {\n    const params = new URLSearchParams({\n      key: '25232082-62f19a20a64b822fbbd43f9d6',\n      q: this.searchQuery,\n      page: this.page,\n      per_page: this.perPage,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n    });\n\n    try {\n      const response = await axios.get(`?${params}`);\n\n      this.incrementPage();\n\n      return response.data;\n    } catch (error) {\n      console.error('Error fetching images:', error);\n      throw error;\n    }\n  }\n\n  get query() {\n    return this.searchQuery;\n  }\n\n  set query(newQuery) {\n    this.searchQuery = newQuery;\n  }\n\n  incrementPage() {\n    this.page += 1;\n  }\n\n  resetPage() {\n    this.page = 1;\n  }\n}\n","export default class LoadMoreBtn {\n  constructor({ selector, hidden = false }) {\n    this.refs = this.getRefs(selector);\n\n    hidden && this.hide();\n  }\n\n  getRefs(selector) {\n    const refs = {};\n\n    refs.button = document.querySelector(selector);\n    refs.label = refs.button.querySelector('.btn__label');\n    refs.spinner = refs.button.querySelector('.spinner');\n\n    return refs;\n  }\n\n  show() {\n    this.refs.button.classList.remove('is-hidden');\n  }\n\n  hide() {\n    this.refs.button.classList.add('is-hidden');\n  }\n\n  disable() {\n    this.refs.button.disabled = true;\n    this.refs.label.textContent = 'Loading...';\n    this.refs.spinner.classList.remove('is-hidden');\n  }\n\n  enable() {\n    this.refs.button.disabled = false;\n    this.refs.label.textContent = 'Load more';\n    this.refs.spinner.classList.add('is-hidden');\n  }\n}\n","import getRefs from './js/getRefs';\nimport renderGalleryItems from './js/render-function';\n\nimport PixabayApiService from './js/pixabay-api';\nimport LoadMoreBtn from './js/load-more-btn';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst refs = getRefs();\nconst pixabayApiService = new PixabayApiService();\nconst loadMoreBtn = new LoadMoreBtn({\n  selector: '[data-action=\"load-more\"]',\n  hidden: true,\n});\nconst lightbox = new SimpleLightbox('.js-gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nrefs.searchForm.addEventListener('submit', onFormSubmit);\nloadMoreBtn.refs.button.addEventListener('click', onLoadMore);\n\nasync function onFormSubmit(evt) {\n  evt.preventDefault();\n\n  const form = evt.currentTarget;\n  const query = form.elements.query;\n  const searchQuery = query.value.trim();\n\n  if (searchQuery === '') {\n    return iziToast.warning({\n      position: 'topRight',\n      message: 'Search query can not be an empty string !',\n    });\n  }\n\n  loadMoreBtn.hide();\n\n  pixabayApiService.query = searchQuery;\n  refs.galleryContainer.innerHTML = '';\n\n  pixabayApiService.resetPage();\n\n  refs.loading.classList.remove('hidden');\n\n  try {\n    const { hits: images, totalHits } = await pixabayApiService.fetchImages(\n      searchQuery\n    );\n\n    if (images.length === 0) {\n      return iziToast.error({\n        position: 'topRight',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n    }\n\n    if (images.length < pixabayApiService.perPage) {\n      loadMoreBtn.hide();\n    } else {\n      loadMoreBtn.show();\n    }\n\n    renderGalleryItems(images);\n\n    lightbox.refresh();\n  } catch (error) {\n    iziToast.error({\n      position: 'topRight',\n      message: 'Sorry, something is wrong',\n    });\n  } finally {\n    form.reset();\n    refs.loading.classList.add('hidden');\n  }\n}\n\nasync function onLoadMore() {\n  loadMoreBtn.disable();\n\n  try {\n    const { hits, totalHits } = await pixabayApiService.fetchImages();\n    const lastPage = Math.ceil(totalHits / pixabayApiService.perPage);\n\n    if (pixabayApiService.page === lastPage) {\n      loadMoreBtn.hide();\n      iziToast.info({\n        position: 'topRight',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n\n    renderGalleryItems(hits);\n    smoothScroll();\n  } catch (error) {\n    iziToast.error({\n      position: 'topRight',\n      message: 'Sorry, something went wrong while loading more images.',\n    });\n  } finally {\n    loadMoreBtn.enable();\n  }\n}\n\nfunction smoothScroll() {\n  const card = document.querySelector('.gallery-img');\n  const cardHeight = card.getBoundingClientRect().height;\n  window.scrollBy({\n    left: 0,\n    top: cardHeight * 4,\n    behavior: 'smooth',\n  });\n}\n"],"names":["getRefs","refs","renderGalleryItems","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","axios","PixabayApiService","params","response","error","newQuery","LoadMoreBtn","selector","hidden","pixabayApiService","loadMoreBtn","lightbox","SimpleLightbox","onFormSubmit","onLoadMore","evt","form","searchQuery","iziToast","totalHits","hits","lastPage","smoothScroll","cardHeight"],"mappings":"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"}